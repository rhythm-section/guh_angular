<div class="modal">
  <h2>Add Rule</h2>

  <form ng-submit="addRule.saveRule()">
    <!-- Events -->
    <ul ng-show="addRule.eventDescriptors.length > 0">
      <li ng-repeat="eventDescriptor in addRule.eventDescriptors track by $index">{{ eventDescriptor.device.name }}: {{ eventDescriptor.name }}</li>
    </ul>
    
    <guh-wizard ng-if="addRule.show.addEvent">
      <br />
      <guh-wizard-step>
        <!-- List devices -->
        <ul>
          <li ng-click="addRule.selectDevice(device)" ng-repeat="device in addRule.devicesWithEventTypes track by $index">{{ device.name }}</li>
        </ul>
      </guh-wizard-step>
      <guh-wizard-step>
        <!-- List events -->
        <guh-device-class model="addRule.currentDevice.deviceClass" save-event-descriptor="addRule.saveEventDescriptor(eventTypeData)" show="{events:true}"></guh-device-class>
      </guh-wizard-step>
      <br />
    </guh-wizard>

    <p><button ng-click="addRule.addEvent()" type="button">Add Event</button></p>


    <!-- States -->
    <ul ng-show="addRule.stateDescriptors.length > 0">
      <li ng-repeat="stateDescriptor in addRule.stateDescriptors track by $index">{{ stateDescriptor.device.name }}: {{ stateDescriptor.name }}</li>
    </ul>

    <guh-wizard ng-if="addRule.show.addState">
      <br />
      <guh-wizard-step>
        <!-- List devices -->
        <ul>
          <li ng-click="addRule.selectDevice(device)" ng-repeat="device in addRule.devicesWithStateTypes track by $index">{{ device.name }}</li>
        </ul>
      </guh-wizard-step>
      <guh-wizard-step>
        <!-- List events -->
        <guh-device-class model="addRule.currentDevice.deviceClass" save-state-descriptor="addRule.saveStateDescriptor(stateTypeData)" show="{states:true}"></guh-device-class>
      </guh-wizard-step>
      <br />
    </guh-wizard>

    <p><button ng-click="addRule.addState()" type="button">Add State</button></p>


    <!-- Actions -->
    <ul ng-show="addRule.actions.length > 0">
      <li ng-repeat="action in addRule.actions track by $index">{{ action.device.name }}: {{ action.name }}</li>
    </ul>

    <guh-wizard ng-if="addRule.show.addAction">
      <br />
      <guh-wizard-step>
        <!-- List devices -->
        <ul>
          <li ng-click="addRule.selectDevice(device)" ng-repeat="device in addRule.devicesWithActions track by $index">{{ device.name }}</li>
        </ul>
      </guh-wizard-step>
      <guh-wizard-step>
        <!-- List events -->
        <guh-device-class model="addRule.currentDevice.deviceClass" save-action="addRule.saveAction(actionData)" show="{actions:true}"></guh-device-class>
      </guh-wizard-step>
      <br />
    </guh-wizard>

    <p><button ng-click="addRule.addAction()" type="button">Add Action</button></p>

    <p><button type="submit">Add Rule</button></p>
  </form>
</div>